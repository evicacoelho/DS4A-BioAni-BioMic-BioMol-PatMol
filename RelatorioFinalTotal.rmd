---
title: Análise da Produção Científica e Acadêmica da Universidade de Brasília - Relatório
  Parcial sobre Pós-Graduação em Ciências Biológicas
author: Emanuel Victor A. Coelho 14/0137475, Jonas Prado 13/0117277 , Maria Júlia
  G. R. Rodrigues 14/0153713
date: "18/11/2018"
output:
  pdf_document:
    latex_engine: xelatex
  html_document: default
  word_document: default
---

# Resumo

Este documento apresenta o relatório final da disciplina de tópicos Avançados em computadores - Turma D - 2018.2 do departamento de Ciência da Computação da universidade de Brasília, que trata da análise da produção científica e acadêmica na Universidade de Brasília, na área de Ciências Biológicas. Para isso, foi aplicado o modelo metodológigo de mineração de dados CRISP-DM e através dele foram dispostas diversas informações sobre a evolução destes programas de pós-graduação entre os anos de 2010 e 2017 (Fernandes et. al., 2018).

# Introdução

Este trabalho visa, no contexto da pós-graduação do sentido amplo e restrito do Brasil, buscar relações e comparações entre os Programas de Pós-Graduação em Biologia Molecular, Biologia Animal, Biologia Microbiana e Patologia Molecular da Universidade de Brasília para sintetizar o panorama e o paradigma da pós-graduação nestes programas.

# CRISP-DM:

A metodologia para desenvolvimento do relatório é baseada no modelo de mineração de dados denominado CRISP-DM (Chapman et al., 2000, Mariscal et al., 2010). Este modelo é caracterizado por um projeto dividido em seis fases, as quais serão tratadas ao longo das seções seguintes.

- Fase 1) Entendimento do negócio: Busca definir um problema de mineração de dados com base nos objetivos e necessidades do projeto.
- Fase 2) Entendimento dos dados: Consiste na coleta e descrição dos dados, incluindo uma análise de qualidade e quantidade dos mesmos - necessários para avaliar a viabilidade do projeto.
- Fase 3) Preparação dos dados: Consiste na estruturação dos dados capturados, incluindo uma fase de limpeza de dados indesejados ou inconsistentes. Esta fase tem como objetivo produzir datasets prontos para análises estatísticas e produção de gráficos.
- Fase 4) Modelagem: Envolve a construção e revisão de modelos estatísticos de interesse para o projeto, além de testes para descarte dos modelos produzidos que não atingirem o grau desejado de confiabilidade.
- Fase 5) Avaliação: Consiste na avaliação dos resultados e do processo como um todo, revisando se todas as questões relevantes para o projeto foram abordadas adequadamente.
- Fase 6) Implementação: Consiste no planejamento e implementação dos entregáveis finais desenvolvidos pelo projeto, incluindo monitoramento e manutenção dos mesmos.

##CRISP-DM Fase 1 - Entendimento do Negócio
##O que é o Sistema Nacional de Pós-Graduação?

A produção do conhecimento científico, no Brasil, é predominantemente efetuada por meio do Sistema Nacional de Pós-Graduação - SNPG, e mais fortemente relacionada com a formação de doutores nesse sistema (Pátaro e Mezzomo, 2013), por meio de cursos de pós-graduação _strictu sensu_. 

Fernandes e Sampaio (2017) já indicaram que a ciência é reconhecidamente um elemento essencial para o desenvolvimento social e econômico de qualquer nação.
Assim sendo, faz-se mister aprimorar o SNPG como forma de promoção desse crescimento, visando maximizar o retorno decorrente do emprego dos recursos nele aplicados. 
A promoção do crescimento do SNPG se dá predominantemente por meio de avaliações regulares de seus programas de pós-graduação, sob responsabilidade da CAPES, que realiza a cada quatro anos um complexo (Leite, 2018, p. 13) e custoso processo de coleta de dados, análise e deliberação sobre as pós-graduações _strictu sensu_, em coerência com o estabelecido no Plano Nacional de Pós-Graduação (PNPG) 2012-2020 (CAPES, 2010) e nos diversos documentos que definem os critérios de organização da pós-graduação em cada área do conhecimento (CAPES, 2018).
Leite (2018) faz uma apresentação geral  de como se organizam e são avaliadas as pós-graduações no Brasil.

O Plano Nacional de Pós-Graduação (PNPG), por outro lado, define diretrizes estratégicas para desenvolvimento da pós-graduação brasileira, que deve abordar prioritariamente grandes temas de interesse nacional, tais como a redução das assimetrias de desenvolvimento entre as regiões do Brasil, a formação de professores para a educação básica, a formação de recursos humanos para as empresas, a resposta aos grandes desafios brasileiros sobre Água, Energia, Transporte, Controle de Fronteiras, Agronegócio, Amazônia, Amazônia Azul (Mar), Saúde, Defesa, Programa Espacial, além de Justiça, Segurança Pública, Criminologia e Desequilíbrio Regional.
O PNPG também traça as diretrizes para financiamento da pós-graduação e sua internacionalização, apresentando conclusões e recomendações.

As avaliações do SNPG, ao atribuirem mensurações de desempenho às diversas pós-graduações que dele fazem parte, geram incentivos e penalidades aos programas, tendo em vista a limitada disponibilidade de recursos para investimento em bolsas, taxas de bancada etc.
Embora o sistema seja altamente sofisticado ele é também altamente criticado (Azevedo et al., 2016), sobretudo porque há percalços na busca por um equilíbrio entre as diferentes concepções de finalidade da ciência. 
Se de um lado a promoção do conhecimento gerado predominantemente nas ditas ciências _hard_ constribui para criar fluxos econômicos mais intensos, isso não significa que essa promoção possa ocorrer em detrimento da menor promoção na geração de conhecimento sobre problemas sociais, predominantemente gerado nas ditas ciências _soft_, especialmente das áreas de humanidades, sob pena de ampliação de desigualdades (Azevedo et al., 2016; Fernandes et. al., 2018).

### Os Colégios, Grandes áreas e áreas da Pós-Graduação Brasileira

A partir de 2018, as diversas áreas da pós-graduação brasileira foram organizadas na forma de colégios, grandes áreas e áreas. Os colégios foram separados da seguinte formar:

- Colégio de Ciências da Vida - que contempla as grandes áreas de Ciências Agrárias, Ciências Biológicas e Ciências da Saúde. 

- Colégio de Ciências Exatas, Tecnológicas e Multidisciplinar - que contempla as grandes áreas de Ciencias Exatas e da Terra, Engenharias e Multidisciplinar.

- Colégio de Humanidades - que contempla as grandes áreas de Ciencias Humanas, Ciencias Sociais Aplicadas e Linguistica, Letras e Artes.

Cada um desses colégios, grandes áreas e áreas de conhecimento possuem dinâmicas próprias, e, portanto, não há um modelo universal que se aplique a todas. Existem aspectos comuns, mas também grandes peculiaridades, descritas parcialmente nos correspondentes documentos de área disponíveis em CAPES (2018) (Fernandes et. al., 2018).

##A UnB dentro do Sistema Nacional de Pós-Graduação

A produção científica da Universidade de Brasília despontou como uma das mais relevantes do país. Segundo o Plano de Internacionalização da Universidade de Brasília 2018-2022, a produção científica da UnB se expandiu consideravelmente período de 2011 a 2016, assim como a relevância das mesma (SciVal, 2018).

![Produção científica.](/home/mustella/Repository/DataScience/DS4A-BioAni-BioMic-BioMol-PatMol-master/Imagem1.jpg)

![Impacto da produção.](/home/mustella/Repository/DataScience/DS4A-BioAni-BioMic-BioMol-PatMol-master/Imagem2.jpg)

Um impacto normalizado de 1,00 significa que a produção teve comportamento similar à média global. Um impacto superior a 1,00 indica maior citação que a média (por exemplo, um impacto de 1,50 indica 50% a mais de citação) enquanto um impacto inferior a 1,00 indica citação inferior à média (SeCom, 2018, Adaptado).

Em 2011, o impacto normalizado por citação foi, de acordo com o gráfico, de aproximadamente 0.85, o que indica que os pesquisadores da UnB foram 15% menos citados do que a média global. Similarmente em 2013, ouve uma redução branda no número de pesquisadores citados. Entretanto, de 2013 até 2016 ouve um aumento considerável nesse impacto normalizado - os pesquisadores da UnB atingiram índice de impacto por citação de 1.45 em 2016, sendo 45% mais citados que a média global.(SeCom, 2018).

Esse aumento na produção cientifica está diretamente associada ao aumento no número de docentes da Universidade. Entre os anos de 2009 e 2013, 577 professores ingressaram no quadro permanente da instituição, com um aumento de 32%. Entre 2013 e 2016, este aumento foi de 185 docentes (8%) (SeCom, 2018). Com um quadro de professores maior espera-se naturalmente uma maior produção de artigos e outros matérias científicos pela UnB.
(SeCom, 2018).

###Captura dos dados: Definindo bancos de dados para as PPGs a partir de arquivos JSON e CSV:

Aqui define-se todas as variáveis base que contém todos os dados utilizados para a realização deste trabalho. Este código estará explícito logo abaixo para demonstrar que utilizou-se dos perfis, dos dados de publicações e orientações de cada um dos docentes. Além disso utilizou-se dados de correlação para a geração de um grafo de correlação ao fim deste trabalho.

```{r, warning=FALSE, message=FALSE}
library(jsonlite) #Importado para carga dos arquivos JSON para o R
# Perfis
perfil.240 <- fromJSON("240BiologiaAnimal/240profile.json")
perfil.242 <- fromJSON("242BiologiaMicrobiana/242profile.json")
perfil.243 <- fromJSON("243BiologiaMolecular/243profile.json")
perfil.313 <- fromJSON("313PatologiaMolecular/313profile.json")
# Publicações
public.240 <- fromJSON("240BiologiaAnimal/240publication.json")
public.242 <- fromJSON("242BiologiaMicrobiana/242publication.json")
public.243 <- fromJSON("243BiologiaMolecular/243publication.json")
public.313 <- fromJSON("313PatologiaMolecular/313publication.json")
# Orientações
orient.240 <- fromJSON("240BiologiaAnimal/240advise.json")
orient.242 <- fromJSON("242BiologiaMicrobiana/242advise.json")
orient.243 <- fromJSON("243BiologiaMolecular/243advise.json")
orient.313 <- fromJSON("313PatologiaMolecular/313advise.json")
# Grafos
graphl.240 <- fromJSON("240BiologiaAnimal/240graph.json")
graphl.242 <- fromJSON("242BiologiaMicrobiana/242graph.json")
graphl.243 <- fromJSON("243BiologiaMolecular/243graph.json")
graphl.313 <- fromJSON("313PatologiaMolecular/313graph.json")
# Todas PPGs
df.prog <- read.table("UnBPosGeral/prof_prog.csv", sep = ",", 
                      colClasses = "character", encoding = "UTF-8", header = TRUE)
```
##CRISP-DM Fase 2 - Entendimento dos Dados

A segunda parte do CRISP-DM consiste no entendimento dos dados. Para realizar análises significativas
com os __datasets__ disponíveis, é essencial ter um bom entendimento sobre a forma que estão organizados. 

Os arquivos utilizados são provenientes da plataforma Elattes e compilam informações sobre aa produção científica dos professores do __Programa de Pós-graduação em Biologia Animal__ no período de 2010 a 2017.

Os __datasets__ que serão trabalhados consistem em: perfil profissional; orientações de mestrado e doutorado realizadas; produções bibliográficas e redes de colaboração entre os pesquisadores.

###Arquivos Analisados

Os arquivos com informações sobre os pesquisadores do Programa de __Biologia Animal__:

* __240BiologiaAnimal/240profile.json__: apresenta dados sobre o __perfil__ de todos os pesquisadores.

* __240BiologiaAnimal/240publication.json__: apresenta dados sobre as __publicações__ e __produções bibliográficas__ geradas por todos os pesquisadores.

* __240BiologiaAnimal/240advise.json__: apresenta dados sobre __orientações de mestrado e doutorado__ feitas por todos os pesquisadores.

* __240BiologiaAnimal/240graph.json__: apresenta dados sobre __produções bibliográficas coolaborativas__ feitas entre os pesquisadores.


###Análise estrutural dos dados

Para continuar com as análises, as seguintes bibliotecas são selecionadas:

```{r, warning=FALSE, message=FALSE,error=FALSE}
#library(tidyverse) #Importado para manipulação de tibbles
library(listviewer) #Importado para análise dos arquivos JSON
library(igraph) #Importado para manipulação de grafo
library(dplyr) #Importado para uso do Operador Pipe
library(tidyr) #Importado para uso da função spread()
library(ggplot2) #Importado para visualizações com ggplot()
library(stringr) #Importado para manipulações de strings
setwd("~/Repository/DataScience/DS4A-BioAni-BioMic-BioMol-PatMol-master")
source("elattes.ls2df.R")
```

Após a importação e definição das bibliotecas utilizadas, podemos utilizar funções de tais pacotes para análise sistêmica dos dados, mas para isto, estes deves sem primeiramente descritos por meio de funções de descrição do pacote `dplyr` que facilita a visualização e manipulação dos dados:

```{r Separação do df.prog, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
df.prog <- df.prog %>% separate(idLattes.Docente.Categoria.Grande.Area.Area.de.Avaliacao.Codigo.AreaPos.Programa,
                     c("idLattes", "Docente", "Categoria", "GrandeArea", "AreaDeAvaliacao", "Codigo", "AreaPos", "Programa"),
                     sep = ";", extra = "drop", fill = "right")
```

*Número de docentes na base e a construção das listas dos mesmos:*
```{r número de docentes, echo=FALSE, message=FALSE, warning=FALSE}
print(c('Biologia Animal:',length(perfil.240)),quote=FALSE)
ProfileList.240 <- list()
for (i in 1:length(perfil.240)) {
  ProfileList.240 <- rbind(ProfileList.240, perfil.240[[i]]$nome)
}
print(c('Biologia Microbiana:',length(perfil.242)),quote=FALSE)
ProfileList.242 <- list()
for (i in 1:length(perfil.242)) {
  ProfileList.242 <- rbind(ProfileList.242, perfil.242[[i]]$nome)
}
print(c('Biologia Molecular:',length(perfil.243)),quote=FALSE)
ProfileList.243 <- list()
for (i in 1:length(perfil.243)) {
  ProfileList.243 <- rbind(ProfileList.243, perfil.243[[i]]$nome)
}
print(c('Patologia Molecular:',length(perfil.313)),quote=FALSE)
ProfileList.313 <- list()
for (i in 1:length(perfil.313)) {
  ProfileList.313 <- rbind(ProfileList.313, perfil.313[[i]]$nome)
}
```

# Análise das listas:
*Número de áreas de atuação cumulativas:*
```{r echo=FALSE, message=TRUE, warning=TRUE}
print(c('Biologia Animal:',sum(sapply(perfil.240, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
print(c('Biologia Microbiana:',sum(sapply(perfil.242, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
print(c('Biologia Moleular:',sum(sapply(perfil.243, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
print(c('Patologia Molecular:',sum(sapply(perfil.313, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
```
*Numero de areas de atuacao por pessoa*
```{r echo=FALSE, paged.print=FALSE}
print('Biologia Animal:', quote=FALSE)
print.table(table(unlist(sapply(perfil.240, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
print('Biologia Microbiana:', quote=FALSE)
print.table(table(unlist(sapply(perfil.242, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
print('Biologia Molecular:', quote=FALSE)
print.table(table(unlist(sapply(perfil.243, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
print('Patologia Molecular:', quote=FALSE)
print.table(table(unlist(sapply(perfil.313, function(x) nrow(x$areas_de_atuacao)))),quote=FALSE)
```
*Numero de pessoas por grande area*
```{r Pessoas por grande área, echo=FALSE, message=FALSE, warning=FALSE}
print('Biologia Animal:', quote=FALSE); table(unlist(sapply(perfil.240, function(x) (x$areas_de_atuacao$grande_area))))
print('Biologia Microbiana:', quote=FALSE); table(unlist(sapply(perfil.242, function(x) (x$areas_de_atuacao$grande_area))))
print('Biologia Molecular:', quote=FALSE); table(unlist(sapply(perfil.243, function(x) (x$areas_de_atuacao$grande_area))))
print('Patologia Molecular:', quote=FALSE); table(unlist(sapply(perfil.313, function(x) (x$areas_de_atuacao$grande_area))))
```
*Numero de pessoas que produziram os especificos tipos de producao*
```{r produção por tipo por pessoa, echo=FALSE, message=FALSE, warning=FALSE}
print('Biologia Animal:', quote=FALSE);table(unlist(sapply(perfil.240, function(x) names(x$producao_bibiografica))))
print('Biologia Microbiana:', quote=FALSE);table(unlist(sapply(perfil.242, function(x) names(x$producao_bibiografica))))
print('Biologia Molecular:', quote=FALSE);table(unlist(sapply(perfil.243, function(x) names(x$producao_bibiografica))))
print('Patologia Molecular:', quote=FALSE); table(unlist(sapply(perfil.313, function(x) names(x$producao_bibiografica))))
```
*Numero de publicacoes por tipo*
```{r produção por tipo geral, echo=FALSE, message=FALSE, warning=FALSE}
print('------ Biologia Animal:', quote=FALSE)
  print(c('Artigos Aceitos:',sum(sapply(perfil.240, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano)))),quote=FALSE)
  print(c('Capítulos de livros:',sum(sapply(perfil.240, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano)))),quote=FALSE)
  print(c('Livros:',sum(sapply(perfil.240, function(x) length(x$producao_bibiografica$LIVRO$ano)))),quote=FALSE)
  print(c('Periódicos:',sum(sapply(perfil.240, function(x) length(x$producao_bibiografica$PERIODICO$ano)))),quote=FALSE)
  print(c('Textos em jornais:',sum(sapply(perfil.240, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano)))),quote=FALSE)

print('------ Biologia Microbiana:', quote=FALSE)
  print(c('Artigos Aceitos:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano)))),quote=FALSE)
  print(c('Capítulos de livros:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano)))),quote=FALSE)
  print(c('Livros:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$LIVRO$ano)))),quote=FALSE)
  print(c('Periódicos:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$PERIODICO$ano)))),quote=FALSE)
  print(c('Textos em jornais:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano)))),quote=FALSE)
  
print('------ Biologia Molecular:', quote=FALSE)
  print(c('Artigos Aceitos:',sum(sapply(perfil.243, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano)))),quote=FALSE)
  print(c('Capítulos de livros:',sum(sapply(perfil.243, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano)))),quote=FALSE)
  print(c('Livros:',sum(sapply(perfil.243, function(x) length(x$producao_bibiografica$LIVRO$ano)))),quote=FALSE)
  print(c('Periódicos:',sum(sapply(perfil.243, function(x) length(x$producao_bibiografica$PERIODICO$ano)))),quote=FALSE)
  print(c('Textos em jornais:',sum(sapply(perfil.243, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano)))),quote=FALSE)

print('------ Patologia Molecular:', quote=FALSE)
  print(c('Artigos Aceitos:',sum(sapply(perfil.313, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano)))),quote=FALSE)
  print(c('Capítulos de livros:',sum(sapply(perfil.313, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano)))),quote=FALSE)
  print(c('Livros:',sum(sapply(perfil.313, function(x) length(x$producao_bibiografica$LIVRO$ano)))),quote=FALSE)
  print(c('Periódicos:',sum(sapply(perfil.313, function(x) length(x$producao_bibiografica$PERIODICO$ano)))),quote=FALSE)
  print(c('Textos em jornais:',sum(sapply(perfil.313, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano)))),quote=FALSE)
```
*Número de pessoas por quantitativo de produções por pessoa*
```{r pessoas quantitativo, echo=FALSE, message=FALSE, warning=FALSE}

print('------ Biologia Animal:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.240, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.240, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.240, function(x) length(x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.240, function(x) length(x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',sum(sapply(perfil.240, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano)))),quote=FALSE)

print('------ Biologia Microbiana:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.242, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.240, function(x) length(x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$LIVRO$ano)))),quote=FALSE)
  print(c('Periódicos:',sum(sapply(perfil.242, function(x) length(x$producao_bibiografica$PERIODICO$ano)))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.240, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)
  
print('------ Biologia Molecular:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.243, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.243, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.243, function(x) length(x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.243, function(x) length(x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.243, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)

print('------ Patologia Molecular:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.313, function(x) length(x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.313, function(x) length(x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.313, function(x) length(x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.313, function(x) length(x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.313, function(x) length(x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)
```
*Número de produções por ano*
```{r produções por ano, echo=FALSE, message=FALSE, warning=FALSE}

print('------ Biologia Animal:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.240, function(x) (x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.240, function(x) (x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.240, function(x) (x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.240, function(x) (x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.240, function(x) (x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)
  
print('------ Biologia Microbiana:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.242, function(x) (x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.242, function(x) (x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.242, function(x) (x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.242, function(x) (x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.242, function(x) (x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)
  
print('------ Biologia Molecular:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.243, function(x) (x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.243, function(x) (x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.243, function(x) (x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.243, function(x) (x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.243, function(x) (x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)

print('------ Patologia Molecular:', quote=FALSE)
  print(c('Artigos Aceitos:',table(unlist(sapply(perfil.313, function(x) (x$producao_bibiografica$ARTIGO_ACEITO$ano))))),quote=FALSE)
  print(c('Capítulos de livros:',table(unlist(sapply(perfil.313, function(x) (x$producao_bibiografica$CAPITULO_DE_LIVRO$ano))))),quote=FALSE)
  print(c('Livros:',table(unlist(sapply(perfil.313, function(x) (x$producao_bibiografica$LIVRO$ano))))),quote=FALSE)
  print(c('Periódicos:',table(unlist(sapply(perfil.313, function(x) (x$producao_bibiografica$PERIODICO$ano))))),quote=FALSE)
  print(c('Textos em jornais:',table(unlist(sapply(perfil.313, function(x) (x$producao_bibiografica$TEXTO_EM_JORNAIS$ano))))),quote=FALSE)
```
*Número de pessoas que realizaram diferentes tipos de orientações*
```{r}
print(c('Biologia Animal:',length(unlist(sapply(perfil.240, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
print(c('Biologia Microbiana:',length(unlist(sapply(perfil.242, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
print(c('Biologia Molecular:',length(unlist(sapply(perfil.243, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
print(c('Patologia Molecular:',length(unlist(sapply(perfil.313, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
```
*Número de pessoas por tipo de orientação*
```{r}
print(c('------ Biologia Animal:',table(unlist(sapply(perfil.240, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
print(c('------ Biologia Microbiana:',table(unlist(sapply(perfil.242, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
print(c('------ Biologia Molecular:',table(unlist(sapply(perfil.243, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
print(c('------ Patologia Molecular:',table(unlist(sapply(perfil.313, function(x) names(x$orientacoes_academicas))))), quote=FALSE)
```
*Número de orientacões concluídas*
```{r}

print('------ Biologia Animal:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',sum(sapply(perfil.240, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',sum(sapply(perfil.240, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',sum(sapply(perfil.240, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano)))),quote=FALSE)

print('------ Biologia Microbiana:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',sum(sapply(perfil.242, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',sum(sapply(perfil.242, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',sum(sapply(perfil.242, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano)))),quote=FALSE)
  
print('------ Biologia Molecular:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',sum(sapply(perfil.243, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',sum(sapply(perfil.243, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',sum(sapply(perfil.243, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano)))),quote=FALSE)
  
print('------ Patologia Molecular:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',sum(sapply(perfil.313, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',sum(sapply(perfil.313, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano)))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',sum(sapply(perfil.313, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano)))),quote=FALSE)
```
*Número de pessoas por quantitativo de orientacões por pessoa*
```{r orientação quantitativo, echo=FALSE, message=FALSE, warning=FALSE}
print('------ Biologia Animal:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.240, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.240, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.240, function(x) 
length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)

print('------ Biologia Microbiana:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.242, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.242, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.242, function(x) 
length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)
  
print('------ Biologia Molecular:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.243, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.243, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.243, function(x) 
length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)
  
print('------ Patologia Molecular:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.313, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.313, function(x) length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.313, function(x) 
length(x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)
```
*Número de orientações por ano*
```{r orientações por ano, message=FALSE, warning=FALSE}
print('------ Biologia Animal:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.240, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.240, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.240, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)

print('------ Biologia Microbiana:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.242, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.242, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.242, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)
  
print('------ Biologia Molecular:', quote=FALSE)
  print(c('Orientações concluídas de mestrados:',table(unlist(sapply(perfil.243, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_MESTRADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de doutorados:',table(unlist(sapply(perfil.243, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_DOUTORADO$ano))))),quote=FALSE)
  print(c('Orientações concluídas de pós-doutores:',table(unlist(sapply(perfil.243, function(x) (x$orientacoes_academicas$ORIENTACAO_CONCLUIDA_POS_DOUTORADO$ano))))),quote=FALSE)
```

```{r include=FALSE}
perfil.240.df.professores <- extrai.perfis(perfil.240)
perfil.242.df.professores <- extrai.perfis(perfil.242)
perfil.243.df.professores <- extrai.perfis(perfil.243)
perfil.313.df.professores <- extrai.perfis(perfil.313)
```

```{r include=FALSE}
perfil.240.df.publicacoes <- extrai.producoes(perfil.240) %>%
  select(tipo_producao, everything()) %>% arrange(tipo_producao)
perfil.240.df.publicacoes$tipo_producao[grepl("DEMAIS",perfil.240.df.publicacoes$tipo_producao)] <- "OUTRAS_PRODUCOES"
perfil.242.df.publicacoes <- extrai.producoes(perfil.242) %>%
  select(tipo_producao, everything()) %>% arrange(tipo_producao)
perfil.242.df.publicacoes$tipo_producao[grepl("DEMAIS",perfil.242.df.publicacoes$tipo_producao)] <- "OUTRAS_PRODUCOES"
perfil.243.df.publicacoes <- extrai.producoes(perfil.243) %>%
  select(tipo_producao, everything()) %>% arrange(tipo_producao)
perfil.243.df.publicacoes$tipo_producao[grepl("DEMAIS",perfil.243.df.publicacoes$tipo_producao)] <- "OUTRAS_PRODUCOES"
perfil.313.df.publicacoes <- extrai.producoes(perfil.313) %>%
  select(tipo_producao, everything()) %>% arrange(tipo_producao)
perfil.313.df.publicacoes$tipo_producao[grepl("DEMAIS",perfil.313.df.publicacoes$tipo_producao)] <- "OUTRAS_PRODUCOES"
```

```{r include=FALSE}
perfil.240.df.orientacoes <- extrai.orientacoes(perfil.240) %>%
  select(id_lattes_orientadores, natureza, ano, orientacao, everything()) %>%
  mutate(situacao = ifelse(grepl("CONCLUIDA", orientacao), "Concluída", "Em andamento")) %>%
  mutate(Natureza = case_when(grepl("MESTRADO", str_to_upper(natureza)) ~ "Mestrado",
                              grepl("PÓS-DOUTORADO", str_to_upper(natureza)) ~ "Pós-doutorado",
                              grepl("DOUTORADO", str_to_upper(natureza)) ~ "Doutorado",
                              grepl("INICIACAO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              grepl("INICIAÇÃO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              TRUE ~ "Outras naturezas"))
perfil.242.df.orientacoes <- extrai.orientacoes(perfil.242) %>%
  select(id_lattes_orientadores, natureza, ano, orientacao, everything()) %>%
  mutate(situacao = ifelse(grepl("CONCLUIDA", orientacao), "Concluída", "Em andamento")) %>%
  mutate(Natureza = case_when(grepl("MESTRADO", str_to_upper(natureza)) ~ "Mestrado",
                              grepl("PÓS-DOUTORADO", str_to_upper(natureza)) ~ "Pós-doutorado",
                              grepl("DOUTORADO", str_to_upper(natureza)) ~ "Doutorado",
                              grepl("INICIACAO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              grepl("INICIAÇÃO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              TRUE ~ "Outras naturezas"))
perfil.243.df.orientacoes <- extrai.orientacoes(perfil.243) %>%
  select(id_lattes_orientadores, natureza, ano, orientacao, everything()) %>%
  mutate(situacao = ifelse(grepl("CONCLUIDA", orientacao), "Concluída", "Em andamento")) %>%
  mutate(Natureza = case_when(grepl("MESTRADO", str_to_upper(natureza)) ~ "Mestrado",
                              grepl("PÓS-DOUTORADO", str_to_upper(natureza)) ~ "Pós-doutorado",
                              grepl("DOUTORADO", str_to_upper(natureza)) ~ "Doutorado",
                              grepl("INICIACAO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              grepl("INICIAÇÃO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              TRUE ~ "Outras naturezas"))
perfil.313.df.orientacoes <- extrai.orientacoes(perfil.313) %>%
  select(id_lattes_orientadores, natureza, ano, orientacao, everything()) %>%
  mutate(situacao = ifelse(grepl("CONCLUIDA", orientacao), "Concluída", "Em andamento")) %>%
  mutate(Natureza = case_when(grepl("MESTRADO", str_to_upper(natureza)) ~ "Mestrado",
                              grepl("PÓS-DOUTORADO", str_to_upper(natureza)) ~ "Pós-doutorado",
                              grepl("DOUTORADO", str_to_upper(natureza)) ~ "Doutorado",
                              grepl("INICIACAO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              grepl("INICIAÇÃO", str_to_upper(natureza)) ~ "Iniciação Científica",
                              TRUE ~ "Outras naturezas"))
```

```{r include=FALSE}
perfil.240.df.areas.de.atuacao <- extrai.areas.atuacao(perfil.240) %>%
  select(idLattes, everything())
perfil.242.df.areas.de.atuacao <- extrai.areas.atuacao(perfil.242) %>%
  select(idLattes, everything())
perfil.243.df.areas.de.atuacao <- extrai.areas.atuacao(perfil.243) %>%
  select(idLattes, everything())
perfil.313.df.areas.de.atuacao <- extrai.areas.atuacao(perfil.313) %>%
  select(idLattes, everything())        
```
*Cria arquivo com dados quantitativos para análise*
  ```{r echo=FALSE}
perfil.240.df <- data.frame()
perfil.240.df <- perfil.240.df.professores %>% 
  select(idLattes, nome, resumo_cv, senioridade) %>% 
  left_join(
    perfil.240.df.orientacoes %>% 
      select(orientacao, idLattes) %>% 
      filter(!grepl("EM_ANDAMENTO", orientacao)) %>% 
      group_by(idLattes) %>% 
      count(orientacao) %>% 
      spread(key = orientacao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.240.df.publicacoes %>% 
      select(tipo_producao, idLattes) %>% 
      filter(!grepl("ARTIGO_ACEITO", tipo_producao)) %>% 
      group_by(idLattes) %>% 
      count(tipo_producao) %>% 
      spread(key = tipo_producao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.240.df.areas.de.atuacao %>% 
      select(area, idLattes) %>% 
      group_by(idLattes) %>% 
      summarise(num_areas = n_distinct(area)), 
    by = "idLattes") %>%
  mutate(num_areas = factor(num_areas))
perfil.240.df[is.na(perfil.240.df)] <- 0 #Remove NAs do dataframe

perfil.240.df.areas.de.atuacao <- perfil.240.df.areas.de.atuacao %>%
  left_join(perfil.240.df, by = "idLattes") %>%
  rowwise() %>% #realizar sum() corretamente
  mutate(orientacoes_concluidas = sum(ORIENTACAO_CONCLUIDA_DOUTORADO,
                                      ORIENTACAO_CONCLUIDA_POS_DOUTORADO, ORIENTACAO_CONCLUIDA_MESTRADO,
                                      OUTRAS_ORIENTACOES_CONCLUIDAS, na.rm = TRUE)) %>%
  mutate(publicacoes = sum(CAPITULO_DE_LIVRO, EVENTO, PERIODICO,
                           LIVRO, TEXTO_EM_JORNAIS, OUTRAS_PRODUCOES, na.rm = TRUE)) %>%
  select(idLattes, grande_area, area, sub_area, especialidade, orientacoes_concluidas, publicacoes)
class(perfil.240.df.areas.de.atuacao) <- c("tbl_df", "data.frame") #desfazer rowwise
print("Biologia Animal")
summary(perfil.240.df)
perfil.242.df <- data.frame()
perfil.242.df <- perfil.242.df.professores %>% 
  select(idLattes, nome, resumo_cv, senioridade) %>% 
  left_join(
    perfil.242.df.orientacoes %>% 
      select(orientacao, idLattes) %>% 
      filter(!grepl("EM_ANDAMENTO", orientacao)) %>% 
      group_by(idLattes) %>% 
      count(orientacao) %>% 
      spread(key = orientacao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.242.df.publicacoes %>% 
      select(tipo_producao, idLattes) %>% 
      filter(!grepl("ARTIGO_ACEITO", tipo_producao)) %>% 
      group_by(idLattes) %>% 
      count(tipo_producao) %>% 
      spread(key = tipo_producao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.242.df.areas.de.atuacao %>% 
      select(area, idLattes) %>% 
      group_by(idLattes) %>% 
      summarise(num_areas = n_distinct(area)), 
    by = "idLattes") %>%
  mutate(num_areas = factor(num_areas))
perfil.242.df[is.na(perfil.242.df)] <- 0 #Remove NAs do dataframe
perfil.242.df.areas.de.atuacao <- perfil.242.df.areas.de.atuacao %>%
  left_join(perfil.242.df, by = "idLattes") %>%
  rowwise() %>% #realizar sum() corretamente
  mutate(orientacoes_concluidas = sum(ORIENTACAO_CONCLUIDA_DOUTORADO,
                                      ORIENTACAO_CONCLUIDA_POS_DOUTORADO, ORIENTACAO_CONCLUIDA_MESTRADO,
                                      OUTRAS_ORIENTACOES_CONCLUIDAS, na.rm = TRUE)) %>%
  mutate(publicacoes = sum(CAPITULO_DE_LIVRO, EVENTO, PERIODICO,
                           LIVRO, TEXTO_EM_JORNAIS, OUTRAS_PRODUCOES, na.rm = TRUE)) %>%
  select(idLattes, grande_area, area, sub_area, especialidade, orientacoes_concluidas, publicacoes)
class(perfil.242.df.areas.de.atuacao) <- c("tbl_df", "data.frame") #desfazer rowwise
print("Biologia Microbiana")
summary(perfil.242.df)

perfil.243.df <- data.frame()
perfil.243.df <- perfil.243.df.professores %>% 
  select(idLattes, nome, resumo_cv, senioridade) %>% 
  left_join(
    perfil.243.df.orientacoes %>% 
      select(orientacao, idLattes) %>% 
      filter(!grepl("EM_ANDAMENTO", orientacao)) %>% 
      group_by(idLattes) %>% 
      count(orientacao) %>% 
      spread(key = orientacao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.243.df.publicacoes %>% 
      select(tipo_producao, idLattes) %>% 
      filter(!grepl("ARTIGO_ACEITO", tipo_producao)) %>% 
      group_by(idLattes) %>% 
      count(tipo_producao) %>% 
      spread(key = tipo_producao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.243.df.areas.de.atuacao %>% 
      select(area, idLattes) %>% 
      group_by(idLattes) %>% 
      summarise(num_areas = n_distinct(area)), 
    by = "idLattes") %>%
  mutate(num_areas = factor(num_areas))
perfil.243.df[is.na(perfil.243.df)] <- 0 #Remove NAs do dataframe
perfil.243.df.areas.de.atuacao <- perfil.243.df.areas.de.atuacao %>%
  left_join(perfil.243.df, by = "idLattes") %>%
  rowwise() %>% #realizar sum() corretamente
  mutate(orientacoes_concluidas = sum(ORIENTACAO_CONCLUIDA_DOUTORADO,
                                      ORIENTACAO_CONCLUIDA_POS_DOUTORADO, ORIENTACAO_CONCLUIDA_MESTRADO,
                                      OUTRAS_ORIENTACOES_CONCLUIDAS, na.rm = TRUE)) %>%
  mutate(publicacoes = sum(CAPITULO_DE_LIVRO, EVENTO, PERIODICO,
                           LIVRO, TEXTO_EM_JORNAIS, OUTRAS_PRODUCOES, na.rm = TRUE)) %>%
  select(idLattes, grande_area, area, sub_area, especialidade, orientacoes_concluidas, publicacoes)
class(perfil.243.df.areas.de.atuacao) <- c("tbl_df", "data.frame") #desfazer rowwise
print("Biologia Molecular")
summary(perfil.243.df)
perfil.313.df <- data.frame()
perfil.313.df <- perfil.313.df.professores %>% 
  select(idLattes, nome, resumo_cv, senioridade) %>% 
  left_join(
    perfil.313.df.orientacoes %>% 
      select(orientacao, idLattes) %>% 
      filter(!grepl("EM_ANDAMENTO", orientacao)) %>% 
      group_by(idLattes) %>% 
      count(orientacao) %>% 
      spread(key = orientacao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.313.df.publicacoes %>% 
      select(tipo_producao, idLattes) %>% 
      filter(!grepl("ARTIGO_ACEITO", tipo_producao)) %>% 
      group_by(idLattes) %>% 
      count(tipo_producao) %>% 
      spread(key = tipo_producao, value = n), 
    by = "idLattes") %>% 
  left_join(
    perfil.313.df.areas.de.atuacao %>% 
      select(area, idLattes) %>% 
      group_by(idLattes) %>% 
      summarise(num_areas = n_distinct(area)), 
    by = "idLattes") %>%
  mutate(num_areas = factor(num_areas))
perfil.313.df[is.na(perfil.313.df)] <- 0 #Remove NAs do dataframe
perfil.313.df.areas.de.atuacao <- perfil.313.df.areas.de.atuacao %>%
  left_join(perfil.313.df, by = "idLattes") %>%
  rowwise() %>% #realizar sum() corretamente
  mutate(orientacoes_concluidas = sum(ORIENTACAO_CONCLUIDA_DOUTORADO,
                                      ORIENTACAO_CONCLUIDA_POS_DOUTORADO, ORIENTACAO_CONCLUIDA_MESTRADO,
                                      OUTRAS_ORIENTACOES_CONCLUIDAS, na.rm = TRUE)) %>%
  mutate(publicacoes = sum(CAPITULO_DE_LIVRO, EVENTO, PERIODICO,
                           LIVRO, TEXTO_EM_JORNAIS, OUTRAS_PRODUCOES, na.rm = TRUE)) %>%
  select(idLattes, grande_area, area, sub_area, especialidade, orientacoes_concluidas, publicacoes)
class(perfil.313.df.areas.de.atuacao) <- c("tbl_df", "data.frame") #desfazer rowwise
print("Patologia Molecular")
summary(perfil.313.df)
```

##CRISP-DM Fase 3 - Preparação dos Dados
A terceira fase do CRISP é conhecida por ser a parte de preparação dos dados. Tal fase possui como
característica a execução de atividades para construir o conjunto final de dados a partir dos dados brutos iniciais. 
Pode-se separar essa etapa em cinco momentos que serão descritos nessa seção.

• Seleção dos dados

• Limpeza dos dados

• Construção dos dados

• Integração dos dados

• Formatação dos dados

Na etapa de seleção dos dados a entrada é o conjunto de dados bruto e nela ocorre a decisão dos dados a serem usados para análise. Os critérios incluem relevância para as metas de mineração de dados, qualidade e restrições técnicas, como limites no volume de dados ou tipos de dados.
Então vem a fase da limpeza que recebe a seleção de dados úteis efetuada anteriormente e é efetuado um aumento na qualidade dos dados para o nível exigido pelas técnicas de análise selecionadas. Aqui pode haver o uso de técnicas mais elaboradas, como a estimativa de dados ausentes por modelagem e inserção de padrões adequados.

O terceiro passo é a construção dos dados. Essa tarefa inclui operações de preparação de dados construtivos, como a produção de atributos derivados, novos registros ou valores transformados para atributos existentes.
A penúltima atividade é a integração dos dados. Este é o momento no qual as informações são combinadas de vários bancos de dados, tabelas ou registros para criar novos registros ou valores.
Por fim, ocorre a tarefa de formatação dos dados, que é a realização de modificações na estrutura dos dados de forma que as operações planejadas possam ser efetuadas de forma conveniente.

Para tornar a análise mais fácil de ser feita e até mesmo para possibilitar a realização de comparações ao final, os mesmos procedimentos foram realizados para os três programas de pós-graduação. Além disso, é importante ressaltar que as variáveis e estruturas montadas foram nomeados de forma mnemônica permitindo a distinção de diferentes programas e aspectos, como orientações, publicações, entre outros.

##Análise dos dados no formato lista
*Número de Publicacoes em periódicos*
  ```{r echo=FALSE}
print(c('Biologia Animal:',sum(sapply(public.240$PERIODICO, function(x) length(x$natureza)))),quote=FALSE)
print(c('Biologia Microbiana:',sum(sapply(public.242$PERIODICO, function(x) length(x$natureza)))),quote=FALSE)
print(c('Biologia Molecular:',sum(sapply(public.243$PERIODICO, function(x) length(x$natureza)))),quote=FALSE)
print(c('Patologia Molecular:',sum(sapply(public.313$PERIODICO, function(x) length(x$natureza)))),quote=FALSE)
```

*Anos analisados*
  ```{r echo=FALSE}
print(c('Biologia Animal:'))
names(public.240$PERIODICO)
print(c('Biologia Microbiana:'))
names(public.242$PERIODICO)
print(c('Biologia Molecular:'))
names(public.243$PERIODICO)
print(c('Patologia Molecular:'))
names(public.313$PERIODICO)
```

*20 revistas mais publicadas*
  ```{r echo=FALSE}
print(c('Biologia Animal:'))
head(sort(table(as.data.frame(unlist
                              (sapply(public.240$PERIODICO, function(x) unlist(x$periodico)))
)), decreasing = TRUE),20)
print(c('Biologia Microbiana:'))
head(sort(table(as.data.frame(unlist
                              (sapply(public.242$PERIODICO, function(x) unlist(x$periodico)))
)), decreasing = TRUE),20)
print(c('Biologia Molecular:'))
head(sort(table(as.data.frame(unlist
                              (sapply(public.243$PERIODICO, function(x) unlist(x$periodico)))
)), decreasing = TRUE),20)
print(c('Patologia Molecular:'))
head(sort(table(as.data.frame(unlist
                              (sapply(public.313$PERIODICO, function(x) unlist(x$periodico)))
)), decreasing = TRUE),20)
```

*Análise dos dados no formato dataframe*
  ```{r echo=FALSE}
public.240.periodico.df <- pub.ls2df(public.240, 1) #artigos
public.240.livros.df <- pub.ls2df(public.240, 2) #livros
public.240.eventos.df <- pub.ls2df(public.240, 5) #eventos
public.242.periodico.df <- pub.ls2df(public.242, 1) #artigos
public.242.livros.df <- pub.ls2df(public.242, 2) #livros
public.242.eventos.df <- pub.ls2df(public.242, 5) #eventos
public.243.periodico.df <- pub.ls2df(public.243, 1) #artigos
public.243.livros.df <- pub.ls2df(public.243, 2) #livros
public.243.eventos.df <- pub.ls2df(public.243, 5) #eventos
public.313.periodico.df <- pub.ls2df(public.313, 1) #artigos
public.313.livros.df <- pub.ls2df(public.313, 2) #livros
public.313.eventos.df <- pub.ls2df(public.313, 5) #eventos

#Dataframe específico para análise de especialidades
especialidade.240.orient <- public.240.eventos.df %>%
  filter (classificacao == "INTERNACIONAL") %>%
  select (`autores-endogeno`) %>%
  separate_rows(`autores-endogeno`, sep = ";") %>%
  distinct() %>%
  arrange(`autores-endogeno`) %>% mutate(internacional = "Sim") %>%
  right_join(perfil.240.df, by = c("autores-endogeno" = "idLattes")) %>%
  left_join(perfil.240.df.areas.de.atuacao, by = c("autores-endogeno" = "idLattes")) %>%
  select(`autores-endogeno`, internacional, especialidade, orientacoes_concluidas) %>% distinct() %>%
  rename(idLattes = `autores-endogeno`)
especialidade.240.orient[is.na(especialidade.240.orient)] <- 0 #Remove NAs do dataframe
especialidade.240.orient$especialidade <- sub("^$", "Não informada", especialidade.240.orient$especialidade)
especialidade.240.orient$internacional <- sub(0, "Não", especialidade.240.orient$internacional)
especialidade.240.orient$programa <- "Biologia Animal" 

especialidade.242.orient <- public.242.eventos.df %>%
  filter (classificacao == "INTERNACIONAL") %>%
  select (`autores-endogeno`) %>%
  separate_rows(`autores-endogeno`, sep = ";") %>%
  distinct() %>%
  arrange(`autores-endogeno`) %>% mutate(internacional = "Sim") %>%
  right_join(perfil.242.df, by = c("autores-endogeno" = "idLattes")) %>%
  left_join(perfil.242.df.areas.de.atuacao, by = c("autores-endogeno" = "idLattes")) %>%
  select(`autores-endogeno`, internacional, especialidade, orientacoes_concluidas) %>% distinct() %>%
  rename(idLattes = `autores-endogeno`)
especialidade.242.orient[is.na(especialidade.242.orient)] <- 0 #Remove NAs do dataframe
especialidade.242.orient$especialidade <- sub("^$", "Não informada", especialidade.242.orient$especialidade)
especialidade.242.orient$internacional <- sub(0, "Não", especialidade.242.orient$internacional)
especialidade.242.orient$programa <- "Biologia Microbiana"

especialidade.243.orient <- public.243.eventos.df %>%
  filter (classificacao == "INTERNACIONAL") %>%
  select (`autores-endogeno`) %>%
  separate_rows(`autores-endogeno`, sep = ";") %>%
  distinct() %>%
  arrange(`autores-endogeno`) %>% mutate(internacional = "Sim") %>%
  right_join(perfil.243.df, by = c("autores-endogeno" = "idLattes")) %>%
  left_join(perfil.243.df.areas.de.atuacao, by = c("autores-endogeno" = "idLattes")) %>%
  select(`autores-endogeno`, internacional, especialidade, orientacoes_concluidas) %>% distinct() %>%
  rename(idLattes = `autores-endogeno`)
especialidade.243.orient[is.na(especialidade.243.orient)] <- 0 #Remove NAs do dataframe
especialidade.243.orient$especialidade <- sub("^$", "Não informada", especialidade.243.orient$especialidade)
especialidade.243.orient$internacional <- sub(0, "Não", especialidade.243.orient$internacional)
especialidade.243.orient$programa <- "Biologia Molecular"

especialidade.313.orient <- public.313.eventos.df %>%
  filter (classificacao == "INTERNACIONAL") %>%
  select (`autores-endogeno`) %>%
  separate_rows(`autores-endogeno`, sep = ";") %>%
  distinct() %>%
  arrange(`autores-endogeno`) %>% mutate(internacional = "Sim") %>%
  right_join(perfil.313.df, by = c("autores-endogeno" = "idLattes")) %>%
  left_join(perfil.313.df.areas.de.atuacao, by = c("autores-endogeno" = "idLattes")) %>%
  select(`autores-endogeno`, internacional, especialidade, orientacoes_concluidas) %>% distinct() %>%
  rename(idLattes = `autores-endogeno`)
especialidade.313.orient[is.na(especialidade.313.orient)] <- 0 #Remove NAs do dataframe
especialidade.313.orient$especialidade <- sub("^$", "Não informada", especialidade.313.orient$especialidade)
especialidade.313.orient$internacional <- sub(0, "Não", especialidade.313.orient$internacional)
especialidade.313.orient$programa <- "Patologia Molecular"

especialidade.total.orient = bind_rows(especialidade.240.orient, especialidade.242.orient, especialidade.243.orient, especialidade.313.orient) 

#Dataframe especifico para análise de áreas de atuação
perfil.240.areas <- perfil.240.df.areas.de.atuacao %>% 
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  group_by(idLattes, orientacoes_concluidas, publicacoes) %>%
  summarise(num_areas = n()) %>% ungroup()
perfil.240.areas$num_areas <- as.factor(perfil.240.areas$num_areas)
perfil.242.areas <- perfil.242.df.areas.de.atuacao %>% 
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  group_by(idLattes, orientacoes_concluidas, publicacoes) %>%
  summarise(num_areas = n()) %>% ungroup()
perfil.242.areas$num_areas <- as.factor(perfil.242.areas$num_areas)
perfil.243.areas <- perfil.243.df.areas.de.atuacao %>% 
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  group_by(idLattes, orientacoes_concluidas, publicacoes) %>%
  summarise(num_areas = n()) %>% ungroup()
perfil.243.areas$num_areas <- as.factor(perfil.243.areas$num_areas)
perfil.313.areas <- perfil.313.df.areas.de.atuacao %>% 
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  group_by(idLattes, orientacoes_concluidas, publicacoes) %>%
  summarise(num_areas = n()) %>% ungroup()
perfil.313.areas$num_areas <- as.factor(perfil.313.areas$num_areas)
```

*Publicações por ano*
  ```{r echo=FALSE}
print("Biologia Animal ")
table(public.240.periodico.df$ano)
print("Biologia Microbiana")
table(public.242.periodico.df$ano)
print("Biologia Molecular")
table(public.243.periodico.df$ano)
print("Patologia Molecular")
table(public.313.periodico.df$ano)
```

*20 revistas mais publicadas (análise com dataframe)*
  ```{r echo=FALSE}
print("Biologia Animal ")
head(sort(table(public.240.periodico.df$periodico), decreasing = TRUE), 20)
print("Biologia Microbiana")
head(sort(table(public.242.periodico.df$periodico), decreasing = TRUE), 20)
print("Biologia Molecular")
head(sort(table(public.243.periodico.df$periodico), decreasing = TRUE), 20)
print("Patologia Molecular")
head(sort(table(public.313.periodico.df$periodico), decreasing = TRUE), 20)
```

*Número de Orientações de Mestrado e Doutorado*
  ```{r echo=FALSE}
print(c("Biologia Animal: ",sum(sapply(orient.240$ORIENTACAO_CONCLUIDA_DOUTORADO, function(x) length(x$natureza))) + 
  sum(sapply(orient.240$ORIENTACAO_CONCLUIDA_MESTRADO, function(x) length(x$natureza)))),quote=FALSE)
print(c("Biologia Microbiana:",sum(sapply(orient.242$ORIENTACAO_CONCLUIDA_DOUTORADO, function(x) length(x$natureza))) + 
  sum(sapply(orient.242$ORIENTACAO_CONCLUIDA_MESTRADO, function(x) length(x$natureza)))),quote=FALSE)
print(c("Biologia Molecular:",sum(sapply(orient.243$ORIENTACAO_CONCLUIDA_DOUTORADO, function(x) length(x$natureza))) + 
  sum(sapply(orient.243$ORIENTACAO_CONCLUIDA_MESTRADO, function(x) length(x$natureza)))),quote=FALSE)
print(c("Patologia Molecular:",sum(sapply(orient.313$ORIENTACAO_CONCLUIDA_DOUTORADO, function(x) length(x$natureza))) + 
  sum(sapply(orient.313$ORIENTACAO_CONCLUIDA_MESTRADO, function(x) length(x$natureza)))),quote=FALSE)
```

*Construição de dataframe de orientações*
  ```{r echo=FALSE}
orient.240.posdoutorado.df <- ori.ls2df(orient.240, 6) #pos-Doutorado concluido
orient.240.doutorado.df <- ori.ls2df(orient.240, 7) #Doutorado concluido
orient.240.mestrado.df <- ori.ls2df(orient.240, 8) #Mestrado concluido
orient.240.df <- rbind(rbind(orient.240.posdoutorado.df, orient.240.doutorado.df), orient.240.mestrado.df)
bolsas.240.df <- orient.240.df %>% filter(bolsa == "SIM") %>%
  group_by(natureza, ano) %>%
  summarise(num_bolsas = n()) %>%
  inner_join((orient.240.df %>%
                group_by(natureza, ano) %>%
                summarise(num_orients = n())), by = c("natureza", "ano")) %>%
  mutate(ratio = num_bolsas/num_orients)
orient.242.posdoutorado.df <- ori.ls2df(orient.242, 6) #pos-Doutorado concluido
orient.242.doutorado.df <- ori.ls2df(orient.242, 7) #Doutorado concluido
orient.242.mestrado.df <- ori.ls2df(orient.242, 8) #Mestrado concluido
orient.242.df <- rbind(rbind(orient.242.posdoutorado.df, orient.242.doutorado.df), orient.242.mestrado.df)
bolsas.242.df <- orient.242.df %>% filter(bolsa == "SIM") %>%
  group_by(natureza, ano) %>%
  summarise(num_bolsas = n()) %>%
  inner_join((orient.242.df %>%
                group_by(natureza, ano) %>%
                summarise(num_orients = n())), by = c("natureza", "ano")) %>%
  mutate(ratio = num_bolsas/num_orients)
orient.243.posdoutorado.df <- ori.ls2df(orient.243, 6) #pos-Doutorado concluido
orient.243.doutorado.df <- ori.ls2df(orient.243, 7) #Doutorado concluido
orient.243.mestrado.df <- ori.ls2df(orient.243, 8) #Mestrado concluido
orient.243.df <- rbind(rbind(orient.243.posdoutorado.df, orient.243.doutorado.df), orient.243.mestrado.df)
bolsas.243.df <- orient.243.df %>% filter(bolsa == "SIM") %>%
  group_by(natureza, ano) %>%
  summarise(num_bolsas = n()) %>%
  inner_join((orient.243.df %>%
                group_by(natureza, ano) %>%
                summarise(num_orients = n())), by = c("natureza", "ano")) %>%
  mutate(ratio = num_bolsas/num_orients)
orient.313.posdoutorado.df <- ori.ls2df(orient.313, 6) #pos-Doutorado concluido
orient.313.doutorado.df <- ori.ls2df(orient.313, 7) #Doutorado concluido
orient.313.mestrado.df <- ori.ls2df(orient.313, 8) #Mestrado concluido
orient.313.df <- rbind(rbind(orient.313.posdoutorado.df, orient.313.doutorado.df), orient.313.mestrado.df)
bolsas.313.df <- orient.313.df %>% filter(bolsa == "SIM") %>%
  group_by(natureza, ano) %>%
  summarise(num_bolsas = n()) %>%
  inner_join((orient.313.df %>%
                group_by(natureza, ano) %>%
                summarise(num_orients = n())), by = c("natureza", "ano")) %>%
  mutate(ratio = num_bolsas/num_orients)
```

*Construção de Grafo de Colaborações*
  ```{r, warning=FALSE,message=FALSE}
g.240 <- g.ls2ig(graphl.240)
df.240 <- as.data.frame(V(g.240)$name); colnames(df.240) <- "Idlattes"
df.240 <- left_join(df.240, df.prog, by = c("Idlattes" = "idLattes"))
g.242 <- g.ls2ig(graphl.242)
df.242 <- as.data.frame(V(g.242)$name); colnames(df.242) <- "Idlattes"
df.242 <- left_join(df.242, df.prog, by = c("Idlattes" = "idLattes"))
g.243 <- g.ls2ig(graphl.243)
df.243 <- as.data.frame(V(g.243)$name); colnames(df.243) <- "Idlattes"
df.243 <- left_join(df.243, df.prog, by = c("Idlattes" = "idLattes"))
g.313 <- g.ls2ig(graphl.313)
df.313 <- as.data.frame(V(g.313)$name); colnames(df.313) <- "Idlattes"
df.313 <- left_join(df.313, df.prog, by = c("Idlattes" = "idLattes"))
perfil.total.df = bind_rows(perfil.240.df, perfil.242.df, perfil.243.df, perfil.313.df) 
```

Apenas para fins de análise inicial, foram retiradas do grafo as observacoes de pesquisadores duplicados quando inclusos em mais de um programa, vide código abaixo.

```{r message=FALSE, warning=FALSE, echo=FALSE}
df.240 <- df.240 %>% group_by(Idlattes) %>% 
  slice(1L)
V(g.240)$programa <- df.240$Programa
V(g.240)$orient_dout <- perfil.240.df$ORIENTACAO_CONCLUIDA_DOUTORADO
V(g.240)$orient_mest <- perfil.240.df$ORIENTACAO_CONCLUIDA_MESTRADO
E(g.240)$publicacao <- perfil.240.df$PERIODICO
E(g.240)$eventos <- perfil.240.df$EVENTO
V(g.240)$color = 'blue'
V(g.240)$name = df.240$Docente
V(g.240)$name = str_extract(V(g.240)$name, '[^ ]+$')
df.242 <- df.242 %>% group_by(Idlattes) %>% 
  slice(1L)
V(g.242)$programa <- df.242$Programa
V(g.242)$orient_dout <- perfil.242.df$ORIENTACAO_CONCLUIDA_DOUTORADO
V(g.242)$orient_mest <- perfil.242.df$ORIENTACAO_CONCLUIDA_MESTRADO
E(g.242)$publicacao <- perfil.242.df$PERIODICO
E(g.242)$eventos <- perfil.242.df$EVENTO
V(g.242)$color = 'yellow'
V(g.242)$name = df.242$Docente
V(g.242)$name = str_extract(V(g.242)$name, '[^ ]+$')
df.243 <- df.243 %>% group_by(Idlattes) %>% 
  slice(1L)
V(g.243)$programa <- df.243$Programa
V(g.243)$orient_dout <- perfil.243.df$ORIENTACAO_CONCLUIDA_DOUTORADO
V(g.243)$orient_mest <- perfil.243.df$ORIENTACAO_CONCLUIDA_MESTRADO
E(g.243)$publicacao <- perfil.243.df$PERIODICO
E(g.243)$eventos <- perfil.243.df$EVENTO
V(g.243)$color = 'green'
V(g.243)$name = df.243$Docente
V(g.243)$name = str_extract(V(g.243)$name, '[^ ]+$')
df.313 <- df.313 %>% group_by(Idlattes) %>% 
  slice(1L)
V(g.313)$programa <- df.313$Programa
V(g.313)$orient_dout <- perfil.313.df$ORIENTACAO_CONCLUIDA_DOUTORADO
V(g.313)$orient_mest <- perfil.313.df$ORIENTACAO_CONCLUIDA_MESTRADO
E(g.313)$publicacao <- perfil.313.df$PERIODICO
V(g.313)$color = 'red'
E(g.313)$eventos <- perfil.313.df$EVENTO
V(g.313)$name = df.313$Docente
V(g.313)$name = str_extract(V(g.313)$name, '[^ ]+$')
grafo = graph.disjoint.union(g.240, g.242, g.243, g.313)%>%
  set_edge_attr('weight', value = (1/1000)*perfil.total.df$PERIODICO) %>%
  set_edge_attr('color', value = factor(perfil.total.df$senioridade)) %>%
  set_edge_attr('width', value =  factor(perfil.total.df$`n_distinct(area)`)) %>%
  set_vertex_attr('size', value = (1/10)*perfil.total.df$PERIODICO)
```

##CRISP-DM Fases 4 a 6 - Resultados e visualizações:
Foram escolhidos alguns resultados, em relação aos dados encontrados durante o processo, para serem plotados em gráficos.

#Biologia Animal

### Grafico de barras; periodicos por ano
```{r echo=FALSE}
public.240.periodico.df %>%
  group_by(ano) %>%
  summarise(Quantidade = n()) %>%
  ggplot(aes(ano, Quantidade, fill = ano)) +
  geom_bar(position = "stack",stat = "identity") +
  ggtitle("Periodicos publicados por ano") +
  geom_text(aes(label=Quantidade), vjust=-0.3, size=2.5)+
  theme_minimal() + labs(x="Ano",y="Quantidade de Periodicos")
```

Sob uma perspectiva de publicações em periódicos, o Programa de Pós-Graduação
de Biologia Animal apresentou pouca variação entre os anos de 2011 e 2017, registrando valores entre 60 e 72 publicações por ano. Um vale único foi encontrado fora deste intervalo, com número de publicações 18% menor que o ano anterior (2015). Ainda assim, este comportamento não foi propagado nos anos seguintes, caracterizando um ano atípico na amostra.

###Quantidade de periodicos publicados por professor(a) entre 2010 e 2017
```{r echo=FALSE}
perfil.240.df %>%
  ggplot(aes(idLattes,PERIODICO, color = num_areas)) +
  geom_point() +
  ggtitle("Periodicos publicados por pesquisador (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Numero de publicacoes") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.240.df %>% summarize(x = median(PERIODICO))), color = "red")
```

O gráfico acima demonstra o total de publicações registradas por cada pesquisador, demonstrando relativa homogeneidade na produção média por pesquisador, uma vez que grande parte das amostras se aproxima da mediana (26 publicações em periódicos). Nota-se, entretanto, um grande destaque para dois pesquisadores que apresentaram mais de 100 publicações no período (cerca de quatro vezes o valor da mediana encontrada). Outra consideração relevante é a constatação de que os 3 pesquisadores com maiores coeficientes no gráfico apresentam apenas uma única área de pesquisa cadastrada, enquanto os pesquisadores com mais áreas de pesquisa apresentaram um índice menor.

###Número de areas de pesquisa e quantidade de eventos por pesquisador
```{r echo=FALSE}
perfil.240.df %>%
  ggplot(aes(idLattes,EVENTO, color = num_areas)) +
  geom_point() +
  ggtitle("Participação dos pesquisadores em eventos (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Quantidade de eventos") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.240.df %>% summarize(x = median(EVENTO))), color = "red")
```

O gráfico acima demonstra o total de eventos registrados por cada pesquisador, demonstrando relativa homogeneidade na participação média de cada pesquisador em eventos, uma vez que grande parte das amostras se aproxima da mediana (11 participações). Ainda assim, alguns *outliars* apresentaram número expressivamente maiores, chegando a quintuplicar a mediana encontrada. É curioso notar que, assim como observado no gráfico de produção de periódicos, os pesquisadores que apresentaram um maior coeficiente de participação em eventos não foram aqueles que relataram um maior número de áreas de pesquisa, induzindo a noção de que pesquisadores especializados apresentam uma maior participação mais expressiva na comunidade acadêmica.

###Publicação de livros por pais/ano
```{r echo=FALSE}
public.240.livros.df %>%
  group_by(ano,pais_de_publicacao) %>%
  ggplot(aes(x=ano,y=pais_de_publicacao, color= pais_de_publicacao)) +
  ggtitle("Livros publicados por ano") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

Denota-se homogeneidade na distribuição de livros publicados para cada país de publicação, onde os Estados Unidos se equiparam ao Brasil quanto a número de lívros publicados para o PPG em Biologia Animal. Ainda assim, é curioso notar que menos da metade dos oito anos da base de dados registraram publicações de livros (2013, 2014, 2016).

###Publicações de capítulos de livros por ano/país
```{r echo=FALSE}
perfil.240.df.publicacoes %>%
  filter((tipo_producao %in% c('LIVRO', 'CAPITULO_DE_LIVRO'))) %>%
  group_by(tipo_producao,pais_de_publicacao) %>%
  ggplot(aes(ano,tipo_producao,col=pais_de_publicacao)) +
  geom_jitter() + ggtitle("Publicações de capítulos de livros por ano/país") +
  labs(x='Tipo de produção',y='País')
```

Trazendo a análise de publicações de capítulos de livros, há um aumento expressivo no número de amostras. Todos os anos analisados (2010-2017) registraram mais de um capítulo de livro publicado pelo PPG em Biologia Animal. Entretanto, a publicação de capítulos não apresenta o mesmo nível de internacionalização que o gráfico anterior. Uma observação curiosa é a grande participação de países estrangeiros no início da amostra, enquanto os anos 2016 e 2017 tem publicações majoritariamente nacionais.

###Eventos nacionais e internacionais
```{r echo=FALSE}
public.240.eventos.df %>%
  filter(pais_do_evento %in% 
           c(names(head(sort(table(public.240.eventos.df$pais_do_evento)
                             , decreasing = TRUE), 10)))) %>%
  group_by(ano_do_trabalho,pais_do_evento) %>%
  ggplot(aes(x=ano_do_trabalho,y=pais_do_evento, color= pais_do_evento)) +
  ggtitle("Participacão em eventos por localização") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

Considerando eventos, o Programa de Biologia Animal teve comparecimento maior
em eventos no Brasil que em países estrangeiros. Ainda assim, o gráfico mostra
que o programa esteve presente em eventos de sede internacional em 
todos os anos registrados na base de dados, principalmente nos Estados Unidos.

###Orientacoes completas por ano e natureza
```{r echo=FALSE}
orient.240.df %>%
  group_by(ano, natureza) %>% summarise(total = n()) %>%
  ggplot(aes(x=ano,y=total,group=natureza,color=natureza)) +
  geom_line() +
  ggtitle("Número de orientações finalizadas por ano") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Quantidade de Orientações")
```

Observando a evolução do número de orientações completas ao longo dos anos,
percebe-se que o Programa de Pós-Graduação em Biologia Animal cresceu na
natureza de mestrado após 2010, mas teve regressões em 2015 e 2017.
Entretanto, não há um comportamento linear na evolução do número de orientações
Além disso, 2013 despontou no número de dissertações de mestrado, mas
teve queda vertiginosa nas demais naturezas. Enquanto as orientações
de mestrado do Programa parecem bem estabelecidas, as supervisões de
pós-doutorado ainda parecem incipientes, tendo em vista que não despontaram
em nenhum dos anos pesquisados e chegaram a zero registros em 2017 - enquanto o doutorado atingiu valor máximo neste mesmo ano.

###Evolução temporal de orientações em andamento e concluídas
```{r echo=FALSE}
perfil.240.df.orientacoes %>% group_by(ano, situacao) %>%
  ggplot(aes(x=situacao,y=ano,color=ano)) +
  geom_jitter(size = 0.8) + facet_wrap(. ~ Natureza) +
  ggtitle("Disposição de orientações por ano")
```

Observou-se uma quantidade praticamente linear no número de iniciações científicas, mestrados e doutorados concluídos no período 2010 – 2017. Conjuntamente a isso, verifica-se um aumento significativo no número de pós-graduações e iniciações científicas em andamento a partir de 2012. Em contrapartida, os pós-doutorados e outros tipos de especialidades tiveram queda no período em questão. Este comportamento, com diversas orientações finalizadas e poucas em andamento, sugere que o PPG em Biologia Animal contemplava poucos cadastros de orientações em andamento e está intensificando esta prática nos anos mais recentes - o que tornará análises futuras ainda mais enriquecedoras.

###Índice de bolsas entre naturezas e evolução temporal
```{r echo=FALSE}
bolsas.240.df %>%
  ggplot(aes(x=ano,y=ratio*100,color=natureza, group=natureza)) +
  geom_line() +
  ggtitle("Porcentagem de orientações contempladas por bolsas") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Índice de bolsas")
```

Comparando os gráficos de orientações completas e de bolsas, é possível
perceber que o número de bolsas oferecidas para o Programa acompanhou o
total de orientações de maneira satisfatória ao longo dos anos.
Durante todo o período, todas as naturezas apresentaram um índice de pelo menos
50% de bolsas, chegando a 100% em alguns casos.
Além disso, as teses de pós-doutorado se mostram a natureza de pesquisa melhor
contemplada pelas agências financiadoras, visto que apenas uma das observações
não recebeu bolsa. Por fim, é possível observar que o pico no número de
orientações de mestrado registrado em 2014 não foi tão expressivo em número
de bolsas, caracterizando um ano com elevado número de alunos não bolsistas.

###Cursos de Mestrado e total de alunos no período (2011-2017)
```{r echo=FALSE}
orient.240.mestrado.df %>%
  group_by(curso) %>%
  summarise(Quantidade = n()) %>% mutate(Quantidade = factor(Quantidade)) %>%
  ggplot(aes(x=Quantidade,y = curso, color = Quantidade)) +
  geom_point() +
  ggtitle('Total de orientações de mestrado') +
  labs(x='Quantidade de alunos',y='Curso do mestrando')
```

AAAAAAA

###Relação de Orientações Concluídas x Publicações por área:
```{r echo=FALSE}
perfil.240.df.areas.de.atuacao %>%
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = area)) +
  geom_jitter(shape = 2, size = .8) +
  ggtitle('Relação de Orientações Concluídas x Publicações') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(grande_area ~ ., ncol = 2)
```

AAAAAAAA Lembrando que um pesquisador possui mais de uma grande area, o pesquisador se repete entre diferentes graficos

###Quantidade de Orientações e Publicações pelo Número de Áreas
```{r echo=FALSE}
perfil.240.areas %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = num_areas)) +
  geom_point() +
  ggtitle('Orientações e Publicações pelo Número de Áreas') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(. ~ num_areas)
```

AAAAA Quem trabalha em mais áreas diferentes publica/orienta mais?

## Biologia Microbiana

### Grafico de barras; Periodicos por ano
```{r}
public.242.periodico.df %>%
  group_by(ano) %>%
  summarise(Quantidade = n()) %>%
  ggplot(aes(ano, Quantidade, fill = ano)) +
  geom_bar(position = "stack",stat = "identity") +
  ggtitle("Periodicos publicados por ano") +
  geom_text(aes(label=Quantidade), vjust=-0.3, size=2.5) +
  theme_minimal() + labs(x="Ano",y="Quantidade de Periodicos")
```

BBBBBBB

###Quantidade de periodicos publicados por professor(a) entre 2010 e 2017
```{r}
perfil.242.df %>%
  ggplot(aes(idLattes,PERIODICO, color = num_areas)) +
  geom_point() +
  ggtitle("Periodicos publicados por pesquisador (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Numero de publicacoes") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.242.df %>% summarize(x = median(PERIODICO))), color = "red")
```

BBBBBBB

###Número de areas de pesquisa e quantidade de eventos por pesquisador
```{r}
perfil.242.df %>%
  ggplot(aes(idLattes,EVENTO, color = num_areas)) +
  geom_point() +
  ggtitle("Participação dos pesquisadores em eventos (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Quantidade de eventos") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.242.df %>% summarize(x = median(EVENTO))), color = "red")
```

BBBBBB

###Publicação de livros por pais/ano
```{r}
public.242.livros.df %>%
  group_by(ano,pais_de_publicacao) %>%
  ggplot(aes(x=ano,y=pais_de_publicacao, color= pais_de_publicacao)) +
  ggtitle("Livros publicados por ano") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

BBBBBBBBBB

###Publicações de capítulos de livros por ano/país
```{r}
perfil.242.df.publicacoes %>%
  filter((tipo_producao %in% c('LIVRO', 'CAPITULO_DE_LIVRO'))) %>%
  group_by(tipo_producao,pais_de_publicacao) %>%
  ggplot(aes(ano,tipo_producao,col=pais_de_publicacao)) +
  geom_jitter() + ggtitle("Publicações de capítulos de livros por ano/país") +
  labs(x='Tipo de produção',y='País')
```

BBBBBBB

###Eventos nacionais e internacionais
```{r}
public.242.eventos.df %>%
  filter(pais_do_evento %in% 
           c(names(head(sort(table(public.242.eventos.df$pais_do_evento)
                             , decreasing = TRUE), 10)))) %>%
  group_by(ano_do_trabalho,pais_do_evento) %>%
  ggplot(aes(x=ano_do_trabalho,y=pais_do_evento, color= pais_do_evento)) +
  ggtitle("Participacão em eventos por localização") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

BBBBBBBB

###Orientacoes completas por ano e natureza
```{r}
orient.242.df %>%
  group_by(ano, natureza) %>% summarise(total = n()) %>%
  ggplot(aes(x=ano,y=total,group=natureza,color=natureza)) +
  geom_line() +
  ggtitle("Número de orientações finalizadas por ano") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Quantidade de Orientações")
```

BBBBBBBBB

###Evolução temporal de orientações em andamento e concluídas
```{r}
perfil.242.df.orientacoes %>% group_by(ano, situacao) %>%
  ggplot(aes(x=situacao,y=ano,color=ano)) +
  geom_jitter(size = 0.8) + facet_wrap(. ~ Natureza) +
  ggtitle("Disposição de orientações por ano")
```

BBBBB

###Índice de bolsas entre naturezas e evolução temporal
```{r}
bolsas.242.df %>%
  ggplot(aes(x=ano,y=ratio*100,color=natureza, group=natureza)) +
  geom_line() +
  ggtitle("Porcentagem de orientações contempladas por bolsas") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Índice de bolsas")
```

BBBB

###Cursos de Mestrado e total de alunos no período (2011-2017)
```{r}
orient.242.mestrado.df %>%
  group_by(curso) %>%
  summarise(Quantidade = n()) %>% mutate(Quantidade = factor(Quantidade)) %>%
  ggplot(aes(x=Quantidade,y = curso, color = Quantidade)) +
  geom_point() +
  ggtitle('Total de orientações de mestrado') +
  labs(x='Quantidade de alunos',y='Curso do mestrando')
```

BBBBBBB

###Relação de Orientações Concluídas x Publicações por área:
```{r}
perfil.242.df.areas.de.atuacao %>%
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = area)) +
  geom_jitter(shape = 2, size = .8) +
  ggtitle('Relação de Orientações Concluídas x Publicações') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(grande_area ~ ., ncol = 2)
```

BBBBB Lembrando que um pesquisador possui mais de uma grande area, o pesquisador se repete entre diferentes graficos

###Quantidade de Orientações e Publicações pelo Número de Áreas
```{r}
perfil.242.areas %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = num_areas)) +
  geom_point() +
  ggtitle('Orientações e Publicações pelo Número de Áreas') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(. ~ num_areas)
```

BBBBB Quem trabalha em mais áreas diferentes publica/orienta mais?

##Biologia Molecular

### Grafico de barras; periodicos por ano
```{r}
public.243.periodico.df %>%
  group_by(ano) %>%
  summarise(Quantidade = n()) %>%
  ggplot(aes(ano, Quantidade, fill = ano)) +
  geom_bar(position = "stack",stat = "identity") +
  ggtitle("Periodicos publicados por ano") +
  geom_text(aes(label=Quantidade), vjust=-0.3, size=2.5)+
  theme_minimal() + labs(x="Ano",y="Quantidade de Periodicos")
```

CCCCCCCCC

###Quantidade de periodicos publicados por professor(a) entre 2010 e 2017
```{r}
perfil.243.df %>%
  ggplot(aes(idLattes,PERIODICO, color = num_areas)) +
  geom_point() +
  ggtitle("Periodicos publicados por pesquisador (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Numero de publicacoes") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.243.df %>% summarize(x = median(PERIODICO))), color = "red")
```

CCCCCCC

###Número de areas de pesquisa e quantidade de eventos por pesquisador
```{r}
perfil.243.df %>%
  ggplot(aes(idLattes,EVENTO, color = num_areas)) +
  geom_point() +
  ggtitle("Participação dos pesquisadores em eventos (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Quantidade de eventos") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.243.df %>% summarize(x = median(EVENTO))), color = "red")
```

CCCCCC

###Publicação de livros por pais/ano
```{r}
public.243.livros.df %>%
  group_by(ano,pais_de_publicacao) %>%
  ggplot(aes(x=ano,y=pais_de_publicacao, color= pais_de_publicacao)) +
  ggtitle("Livros publicados por ano") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

CCCCCCCCC

###Publicações de capítulos de livros por ano/país
```{r}
perfil.243.df.publicacoes %>%
  filter((tipo_producao %in% c('LIVRO', 'CAPITULO_DE_LIVRO'))) %>%
  group_by(tipo_producao,pais_de_publicacao) %>%
  ggplot(aes(ano,tipo_producao,col=pais_de_publicacao)) +
  geom_jitter() + ggtitle("Publicações de capítulos de livros por ano/país") +
  labs(x='Tipo de produção',y='País')
```

CCCCCCCCC

###Eventos nacionais e internacionais
```{r}
public.243.eventos.df %>%
  filter(pais_do_evento %in% 
           c(names(head(sort(table(public.243.eventos.df$pais_do_evento)
                             , decreasing = TRUE), 10)))) %>%
  group_by(ano_do_trabalho,pais_do_evento) %>%
  ggplot(aes(x=ano_do_trabalho,y=pais_do_evento, color= pais_do_evento)) +
  ggtitle("Participacão em eventos por localização") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

CCCCCCCCC

###Orientacoes completas por ano e natureza
```{r}
orient.243.df %>%
  group_by(ano, natureza) %>% summarise(total = n()) %>%
  ggplot(aes(x=ano,y=total,group=natureza,color=natureza)) +
  geom_line() +
  ggtitle("Número de orientações finalizadas por ano") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Quantidade de Orientações")
```

CCCCCCCCC

###Evolução temporal de orientações em andamento e concluídas
```{r}
perfil.243.df.orientacoes %>% group_by(ano, situacao) %>%
  ggplot(aes(x=situacao,y=ano,color=ano)) +
  geom_jitter(size = 0.8) + facet_wrap(. ~ Natureza) +
  ggtitle("Disposição de orientações por ano")
```

CCCCCCCCC

###Índice de bolsas entre naturezas e evolução temporal
```{r}
bolsas.243.df %>%
  ggplot(aes(x=ano,y=ratio*100,color=natureza, group=natureza)) +
  geom_line() +
  ggtitle("Porcentagem de orientações contempladas por bolsas") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Índice de bolsas")
```

CCCCCCCCCCCC

###Cursos de Mestrado e total de alunos no período (2011-2017)
```{r}
orient.243.mestrado.df %>%
  group_by(curso) %>%
  summarise(Quantidade = n()) %>% mutate(Quantidade = factor(Quantidade)) %>%
  ggplot(aes(x=Quantidade,y = curso, color = Quantidade)) +
  geom_point() +
  ggtitle('Total de orientações de mestrado') +
  labs(x='Quantidade de alunos',y='Curso do mestrando')
```

CCCCCCCCC

###Relação de Orientações Concluídas x Publicações por área:
```{r}
perfil.243.df.areas.de.atuacao %>%
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = area)) +
  geom_jitter(shape = 2, size = .8) +
  ggtitle('Relação de Orientações Concluídas x Publicações') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(grande_area ~ ., ncol = 2)
```

CCCCCCC Lembrando que um pesquisador possui mais de uma grande area, o pesquisador se repete entre diferentes graficos

###Quantidade de Orientações e Publicações pelo Número de Áreas
```{r}
perfil.243.areas %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = num_areas)) +
  geom_point() +
  ggtitle('Orientações e Publicações pelo Número de Áreas') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(. ~ num_areas)
```

CCCCCCCCCC Quem trabalha em mais áreas diferentes publica/orienta mais?

## Patologia Molecular

### Grafico de barras; periodicos por ano
```{r}
public.313.periodico.df %>%
  group_by(ano) %>%
  summarise(Quantidade = n()) %>%
  ggplot(aes(ano, Quantidade, fill = ano)) +
  geom_bar(position = "stack",stat = "identity") +
  ggtitle("Periodicos publicados por ano") +
  geom_text(aes(label=Quantidade), vjust=-0.3, size=2.5)+
  theme_minimal() + labs(x="Ano",y="Quantidade de Periodicos")
```

Sob uma perspectiva de publicações em periódicos, o Programa de Pós-Graduação de Patologia Molecular
apresentou um grande crescimento entre os anos de 2011 e 2015, evoluindo gradualmente a ponto totalizar um aumento de 109% na produção anual neste intervalo (de 54 para 113). Após atingir este pico em 2015, o PPG teve redução no número de publicações nos anos seguintes. Considerando a participação de 23 docentes no programa em 2017, foi atingida uma média de 4,22 publicações em periódicos por professor no ano em questão.

###Quantidade de periodicos publicados por professor(a) entre 2010 e 2017
```{r}
perfil.313.df %>%
  ggplot(aes(idLattes,PERIODICO, color = num_areas)) +
  geom_point() +
  ggtitle("Periodicos publicados por pesquisador (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Numero de publicacoes") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.313.df %>% summarize(x = median(PERIODICO))), color = "red")
```

O gráfico acima demonstra o total de publicações registradas por cada pesquisador do PPG de Patologia Molecular, demonstrando relativa
homogeneidade na produção média por pesquisador, uma vez que grande parte das amostras se aproxima da
mediana (26 publicações em periódicos). É curioso observar que, apesar de os gráficos se comportarem de maneira diferente, a mediana foi a mesma obtida pelo Programa de Biologia Animal, apresentado anteriormente.

Nota-se aqui um grande destaque para um pesquisador que apresentou 233 publicações, quase 9 vezes o valor obtido pela mediana. Além disso, 22 dos 23 pesquisadores do PPG de Patologia estão relacionados a mais de uma área de pesquisa - revelando um foco menor do programa em especialização e maior em multidisciplinaridade.


###Número de areas de pesquisa e quantidade de eventos por pesquisador
```{r}
perfil.313.df %>%
  ggplot(aes(idLattes,EVENTO, color = num_areas)) +
  geom_point() +
  ggtitle("Participação dos pesquisadores em eventos (incluindo mediana)") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Pesquisador(a)",y="Quantidade de eventos") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  geom_hline(yintercept = sum(perfil.313.df %>% summarize(x = median(EVENTO))), color = "red")
```

O gráfico acima demonstra o total de eventos registrados por cada pesquisador, demonstrando relativa homo-
geneidade na participação média de cada pesquisador em eventos, uma vez que grande parte das amostras se
aproxima da mediana (20 participações). Assim como na relação de periódicos, há um pesquisador com muito mais participações registradas que seus colegas de programa (10 vezes o valor da mediana), sendo este o mesmo docente que atingiu o pico no número de periódicos. É curioso notar que o único pesquisador cadastrado com apenas uma área de pesquisa não apresentou nenhuma participação em eventos, reiterando uma proposta de multidisciplinaridade do PPG de Patologia Molecular.

###Publicação de livros por pais/ano
```{r}
public.313.livros.df %>%
  group_by(ano,pais_de_publicacao) %>%
  ggplot(aes(x=ano,y=pais_de_publicacao, color= pais_de_publicacao)) +
  ggtitle("Livros publicados por ano") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

Denota-se no PPG de Patologia Molecular uma certa homogeneidade temporal na distribuição de livros publicados para cada país de publicação, com sete publicações em cinco anos diferentes. Curiosamente, nota-se que este é o único programa que não apresentou nenhum livro publicado fora do Brasil no período analisado. Uma das possíveis justificativas para este baixo índice comparativo é o fato de ser o programa de criação mais recente entre os programas aqui analisados, revelando neste um processo de maturação em andamento no aspecto de internacionalização.

###Publicações de capítulos de livros por ano/país
```{r}
perfil.313.df.publicacoes %>%
  filter((tipo_producao %in% c('LIVRO', 'CAPITULO_DE_LIVRO'))) %>%
  group_by(tipo_producao,pais_de_publicacao) %>%
  ggplot(aes(ano,tipo_producao,col=pais_de_publicacao)) +
  geom_jitter() + ggtitle("Publicações de capítulos de livros por ano/país") +
  labs(x='Tipo de produção',y='País')
```

Trazendo a análise de publicações de capítulos de livros, há um aumento expressivo no número de amostras, em relação a considerar apenas livros.
Todos os anos analisados (2010-2017) registraram mais de um capítulo de livro publicado pelo PPG em
Patologia Molecular. Neste eixo, o nível de internacionalização
foi consideravelmente maior que o anterior, com a menção a diversos países da América e Europa. Entretento, a redução da participação internacional do programa em livros é evidente nos anos 2016 e 2017, com publicações nacionais, principalmente - assim como nos demais programas analisados.

###Eventos nacionais e internacionais
```{r}
public.313.eventos.df %>%
  filter(pais_do_evento %in% 
           c(names(head(sort(table(public.313.eventos.df$pais_do_evento)
                             , decreasing = TRUE), 10)))) %>%
  group_by(ano_do_trabalho,pais_do_evento) %>%
  ggplot(aes(x=ano_do_trabalho,y=pais_do_evento, color= pais_do_evento)) +
  ggtitle("Participacão em eventos por localização") +
  xlab("Ano") + ylab("Pais") + geom_jitter()
```

Considerando eventos, o Programa de Patologia Molecular teve comparecimento muito maior em eventos no Brasil que
em países estrangeiros, como esperado. Ainda assim, o gráfico mostra que o programa teve boa presença em eventos de sede
internacional nos anos iniciais da base de dados, com destaque para 2012. Além disso, é notável a queda no número de participações a partir do ano de 2015, tanto nacionais quanto internacionais - revelando pouca correlação entre a participação de eventos e publicação de períodicos (mostrada anteriormente).

###Orientacoes completas por ano e natureza
```{r}
orient.313.df %>%
  group_by(ano, natureza) %>% summarise(total = n()) %>%
  ggplot(aes(x=ano,y=total,group=natureza,color=natureza)) +
  geom_line() +
  ggtitle("Número de orientações finalizadas por ano") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Quantidade de Orientações")
```

Observando a evolução do número de orientações completas ao longo dos anos,
percebe-se que o Programa de mestrado cresceu consideravelmente entre
2010 e 2014, mas apresentou regressão nos períodos posteriores, chegando ao seu
menor índice em 2016. Em contrapartida, o número de orientações de pós-doutorado apresentou maior estabilidade ao longo da amostra, mesmo que com valores reduzidos. Todas
as naturezas de orientação do Programa parecem bem estabelecidas, visto que
mesmo os índices de doutorado apresentaram ao menos 15 observações/ano. Ainda assim, é notável a queda no número de orientações de 2014 para 2015 - o que corrobora com as análises anteriores de queda de participação em eventos no ano em questão.

###Evolução temporal de orientações em andamento e concluídas
```{r}
perfil.313.df.orientacoes %>% group_by(ano, situacao) %>%
  ggplot(aes(x=situacao,y=ano,color=ano)) +
  geom_jitter(size = 0.8) + facet_wrap(. ~ Natureza) +
  ggtitle("Disposição de orientações por ano")
```

Observou-se uma quantidade praticamente linear no número de iniciações científicas, mestrados e doutorados
concluídos no período 2010–2014, com uma queda relevante após 2015. As iniciações científicas tiveram queda vertiginosa em 2017, o que sinaliza uma queda no número de pessoas envolvidas na pesquisa também na graduação. Conjuntamente a isso, verifica-se um aumento significativo no número de
orientações em andamento a partir de 2014. O comportamento prévio a este ano, com diversas orientações finalizadas e poucas em andamento, sugere que o PPG em Patologia Molecular contemplava poucos cadastros de orientações em andamento e está intensificando esta prática nos anos mais recentes - o que
tornará análises futuras ainda mais enriquecedoras.

###Índice de bolsas entre naturezas e evolução temporal
```{r}
bolsas.313.df %>%
  ggplot(aes(x=ano,y=ratio*100,color=natureza, group=natureza)) +
  geom_line() +
  ggtitle("Porcentagem de orientações contempladas por bolsas") +
  theme(legend.position="right",legend.text=element_text(size=7)) +
  guides(fill=guide_legend(nrow=5, byrow=TRUE, title.position = "top")) +
  labs(x="Ano",y="Índice de bolsas")
```

Observando o gráfico de porcentagem de bolsas do Programa de Patologia Molecular, é possível perceber que o número de bolsas oferecidas se comportou de maneira não linear ao longo dos anos.
Durante todo o período, todas as naturezas apresentaram um índice de pelo menos 50% de bolsas. Além disso, as teses de pós-doutorado se mostram a natureza de pesquisa melhor contemplada pelas agências financiadoras, visto que foram a única natureza de pós-doutorado que atingiu 90% em algum momento da amostra. Por
fim, é possível observar que o pico no número de orientações de mestrado registrado em 2014 foi acompanhado por um aumento de 15% no índice de alunos contemplados com bolsa, revelando um ano de grande crescimento na área de mestrado do PPG de Patologia Molecular.


###Cursos de Mestrado e total de alunos no período (2011-2017)
```{r}
orient.313.mestrado.df %>%
  group_by(curso) %>%
  summarise(Quantidade = n()) %>% mutate(Quantidade = factor(Quantidade)) %>%
  ggplot(aes(x=Quantidade,y = curso, color = Quantidade)) +
  geom_point() +
  ggtitle('Total de orientações de mestrado') +
  labs(x='Quantidade de alunos',y='Curso do mestrando')
```

A análise de cursos dos alunos de mestrado orientados pelos professores do PGG de Patologia Molecular apresenta um grande índice de correlação com outras áreas. O curso com maior número de orientações do programa é ele mesmo, como esperado (49 orientações). Entretanto, é visível a relação íntima dos docentes com o Programa de Biologia Molecular, com 40 orientações. Em seguida, são listados diversos outros programas de pós-graduação com quantidade significativa de orientados cadastrados - não se limitando aos que foram analisados neste trabalho.

###Relação de Orientações Concluídas x Publicações por área:
```{r}
perfil.313.df.areas.de.atuacao %>%
  select(-sub_area, -especialidade) %>%
  distinct() %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = area)) +
  geom_jitter(shape = 2, size = .8) +
  ggtitle('Relação de Orientações Concluídas x Publicações') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(grande_area ~ ., ncol = 2)
#Comentei o Facet pois ele oculta a amostra diferenciada
```

DDDDDDD Lembrando que um pesquisador possui mais de uma grande area, o pesquisador se repete entre diferentes graficos

###Quantidade de Orientações e Publicações pelo Número de Áreas
```{r}
perfil.313.areas %>%
  ggplot(aes(publicacoes, orientacoes_concluidas, color = num_areas)) +
  geom_point() +
  ggtitle('Orientações e Publicações pelo Número de Áreas') +
  labs(x='Publicações',y='Orientações concluídas') + facet_wrap(. ~ num_areas)
#Comentei o Facet pois ele oculta a amostra diferenciada
```

DDDDDDDDDD Quem trabalha em mais áreas diferentes publica/orienta mais?

###Quantidade de Orientações e Participação internacional por PPG

```{r}
especialidade.total.orient %>%
  ggplot(aes(internacional, orientacoes_concluidas, color = programa, shape = programa)) +
  geom_jitter(size = 1.1) +
  ggtitle('Orientações concluidas x Participação em congressos internacionais') +
  labs(x='Participacao internacional',y='Orientações concluídas')
```

EEEEEEEE

###Grafo de proximidade entre pesquisadores do Programa de Pós-Graduação
```{r fig.height=9.375, fig.width=12.5}
plot(grafo, vertex.label=V(grafo)$name, layout = layout.auto,
      edge.arrow.width = 0.3,
      edge.size = 3,
      edge.arrow.size = 0.5,
      vertex.size2 = 3,
      vertex.label.cex = 0.7,
      vertex.label.color = 'black',
      vertex.label.family = 'ArialMT',
      asp = 0.0,
      margin = 0.0)
```

Este grafo demonstra a rede de cooperação, peso, quantidades de publicações e senioridade dos indivíduos e da cooperação entre eles. Cada círculo representa um docente dentro de um PPG indicado pela cor, onde: azul é a PPG de Biologia Animal; amarelo é PPG de Biologia Microbiana; verde corresponde a PPG de Biologia Molecular; e vermelho a PPG de Patologia Molecular. Já para cada aresta, as cores determinam a senioridade entre os dois pontos, onde verde é 9, azul é 8 e laranja é 7; quanto ao diametro é dado pela a quantidade de áreas um vértice compartilha com o outro; já para a ligação da aresta, esta é dada pelos os periódicos em comum para cada vértice, indicando cooperação. A partir deste grafo é possível entender que cada programa de pós graduação se mantém praticamente isolado, exceto pelos os docentes que se repetem para cada PPG. É notável que a maioria destas PPGs tem muita intracomunicação, deixando poucos docentes isolados exceto pela a PPG de Biologia Microbiana que tiveram seis docentes completamente isolados de qualquer outra PPG e dela mesma, tendo o maior número de isolamentos. É possível perceber também que a docente de sobrenome Cynthia Maria Kyaw é uma comunicadora entre PPGs, pois intercomunica as PPGs de Biologia Molecular e Biologia Microbiana e além disso previne o isolamento entre sua própria PPG formando uma ponte entre um e outro grupo de docentes que estariam isolados se não colaborassem com esta. Em cada uma das PPGs há docentes em destaque pela a quantidade de publicações (indicada pelo o diâmetro do vértice), mas é possível perceber que o PPG de Patologia Molecular tem uma dominância de um docente que publica aproximadamente o triplo que o anterior em publicações, o que resulta em um grande vértice central. Este dominante também está com a maioria das interligações de seu PPG, sendo portanto um canal de informação dentro de seu grupo.

##Bibliografia

"SciVal Metrics Guidebook." ELSEVIER, 2014.

Chapman, Pete, Julian Clinton, Randy Kerber, Thomas Khabaza, Thomas Reinartz, Colin Shearer, e Rüdiger Wirth. “CRISP-DM 1.0: Step-by-Step Data Mining Guide”. USA: CRISP-DM Consortium, 2000. Disponível em: https://www.the-modeling-agency.com/, visitado em Novembro, 2019.

Fernandes, Jorge H C, Ricardo Barros Sampaio, e João Ribas de Moura. “Ciência de Dados para Todos (Data Science For All) - 2018.1 - Análise da Produção Cientíﬁca e Acadêmica da Universidade de Brasília - Modelo de Relatório Final da Disciplina - Departamento de Ciência da Computação da UnB”. Disciplina 116297 - Tópicos Avançados em Computadores, turma D, do semestre 2018.1, do Departamento de Ciência da Computação do Instituto de Ciências Exatas da Universidade de Brasília, 13 de junho de 2018

Secretaria de Comunicação da UnB (SeCom). 2018. "Impacto da produção científica da UnB aumenta mais de 100% em seis anos." Universidade de Brasília, Junho de 2018, Disponível em https://www.noticias.unb.br/, visitado em Novembro de 2018. 

Azevedo, Mário Luiz Neves de, João Ferreira de Oliveira, e Afrânio Mendes Catani. “O Sistema Nacional de Pós-Graduação (SNPG) e o Plano Nacional de Educação (PNE 2014-2024): regulação, avaliação e ﬁnanciamento”. Revista Brasileira de Política e Administração da Educação 32, nº 3 (2016). http://dx.doi.org/10.21573/vol32n32016.68576.

Leite, Fernando César Lima. “Considerações básicas sobre a Avaliação do Sistema Nacional de PósGraduação”. Comunicação Pessoal (slides). Universidade de Brasília, abril de 2018.

CAPES. “Documentos de Área”. CAPES.gov.br. Acessado 12 de junho de 2018. Disponível em: http://avaliacaoquadrienal.capes.gov.br/, visitado em Dezembro de 2018.

Pátaro, Cristina Saitê de Oliveira, e Frank Antonio Mezzomo. “Sistema Nacional de Pós-Graduação no Brasil: estrutura, resultados e desaﬁos para política de Estado - Lívio Amaral”. Revista Educação e Linguagens 2, nº 3 (julho de 2013): 11–17.

Fernandes, Jorge H C, e Ricardo Barros Sampaio. “DataScienceForAll”. Zotero, 13 de junho de 2018
 
